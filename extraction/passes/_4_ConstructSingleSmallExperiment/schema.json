{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://example.org/schemas/hybridization-article.schema.json",
    "title": "Hybridization Article",
    "description": "Per-article extraction of hybridization experiments as target-probe pairs (plus primers/related sequences). Includes decorated oligos (fluorophores/quenchers, 5'/3' marks, sense/antisense), and parameters stored as raw text and normalized SI.",
    "type": "object",
    "unevaluatedProperties": false,
    "additionalProperties": false,
    "required": [
        "experiment",
        "extraction_report"
    ],
    "$defs": {
        "extractionReport": {
            "type": "object",
            "description": "Structured way to declare missing/uncertain items to avoid hallucination. Use JSON Pointers for field locations.",
            "additionalProperties": false,
            "required": [
                "missing",
                "uncertain",
                "notes"
            ],
            "properties": {
                "missing": {
                    "type": "array",
                    "description": "JSON Pointers to fields that are truly unavailable in the article.",
                    "items": {
                        "type": "string",
                        "minLength": 1
                    },
                    "minItems": 0
                },
                "uncertain": {
                    "type": "array",
                    "description": "JSON Pointers to fields that are ambiguous or weakly supported.",
                    "items": {
                        "type": "string",
                        "minLength": 1
                    },
                    "minItems": 0
                },
                "notes": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Free-text clarifications, e.g., OCR issues, mapping choices."
                }
            }
        },
        "iupacBases": {
            "type": "string",
            "description": "DNA/RNA bases in uppercase IUPAC alphabet: A C G U/T R Y S W K M B D H V N. No separators and no ellipsis inside the sequence.",
            "pattern": "^([ACGUTRYSWKMBDHVN]+)$|^(Exact sequence unknown, here is its description: (.*))$",
            "minLength": 5,
            "maxLength": 5000
        },
        "provenance": {
            "type": "object",
            "description": "Where a value was obtained in the source document.",
            "additionalProperties": false,
            "properties": {
                "source_type": {
                    "type": "string",
                    "enum": [
                        "pdf",
                        "html",
                        "other",
                        "unknown"
                    ],
                    "description": "Type of source the extractor processed."
                },
                "page": {
                    "type": [
                        "integer",
                        "null"
                    ],
                    "minimum": 1,
                    "description": "Page number in the source (1-based), if applicable."
                },
                "section": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Section header or caption in which the value appears."
                },
                "quote": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Short verbatim snippet from the article that directly supports the value."
                },
                "notes": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Extractor notes (e.g., OCR artifact, inferred mapping)."
                }
            }
        },
        "measurement": {
            "type": "object",
            "description": "Numeric (or quasi-numeric) item holding raw text, optional parsed value/unit, and normalized SI value/unit.",
            "additionalProperties": false,
            "required": [
                "raw",
                "value",
                "unit",
                "si_value",
                "si_unit",
                "assumptions"
            ],
            "properties": {
                "raw": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 200,
                    "description": "Exact text as written in the article (e.g., '58 °C', '2 mM', '10%')."
                },
                "value": {
                    "type": [
                        "number",
                        "null"
                    ],
                    "description": "Parsed numeric value if present in raw."
                },
                "unit": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Unit as written in the article (e.g., '°C', 'mM', '%')."
                },
                "si_value": {
                    "type": [
                        "number",
                        "null"
                    ],
                    "description": "Value converted to SI. Examples: temperature in K; concentrations in mol/m^3; fractions 0-1 for percent."
                },
                "si_unit": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "enum": [
                        "K",
                        "mol/m^3",
                        "Pa",
                        "kg/m^3",
                        "s",
                        "dimensionless",
                        "%",
                        "kg",
                        "mol",
                        "m",
                        null
                    ],
                    "description": "SI unit after conversion."
                },
                "assumptions": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Conversion assumptions (e.g., density used, ionic strength conventions)."
                },
                "provenance": {
                    "$ref": "#/$defs/provenance"
                }
            }
        },
        "decoratedOligo": {
            "type": "object",
            "description": "An oligonucleotide possibly decorated at 5'/3' with labels (fluorophores/quenchers). Keeps raw string and parsed parts.",
            "additionalProperties": false,
            "required": [
                "raw",
                "sequence",
                "length_bases",
                "prime_prefix",
                "five_prime_label",
                "three_prime_label",
                "labels",
                "sense_antisense"
            ],
            "properties": {
                "raw": {
                    "type": "string",
                    "minLength": 5,
                    "maxLength": 200,
                    "description": "Exact oligo string as seen. MUST CONTAIN NUCLEOTIDES, NOT ONLY NAMES. DO NOT COPY THIS SEQUENCE FROM THE EXAMPLE! NEVER USE ELLIPSIS OR SKIP ANY DATA IN YOUR RESPONSE!!!"
                },
                "sequence": {
                    "$ref": "#/$defs/iupacBases",
                    "description": "Bare base sequence with IUPAC letters only (no labels/hyphens)."
                },
                "length_bases": {
                    "type": [
                        "integer",
                        "null"
                    ],
                    "minimum": 1,
                    "description": "Base length if given or derivable (e.g., '(27 b)')."
                },
                "prime_prefix": {
                    "type": [
                        "integer",
                        "null"
                    ],
                    "enum": [
                        3,
                        5,
                        null
                    ],
                    "description": "Leading prime marker if present (3 or 5). Accepts OCR artifacts like 50/5O/5' during parsing."
                },
                "five_prime_label": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Label at the 5' end if indicated (e.g., FAM, ROX)."
                },
                "three_prime_label": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Label at the 3' end if indicated (e.g., BHQ1, BHQ2, RTQ1)."
                },
                "labels": {
                    "type": "array",
                    "description": "All labels found in textual order, including 5' and 3' labels.",
                    "minItems": 0,
                    "maxItems": 10,
                    "items": {
                        "type": "string"
                    }
                },
                "sense_antisense": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "enum": [
                        "sense",
                        "antisense",
                        null
                    ],
                    "description": "If the oligo is explicitly designated as sense (s) or antisense (as) in the article."
                },
                "provenance": {
                    "$ref": "#/$defs/provenance"
                }
            }
        },
        "primerPair": {
            "type": "object",
            "description": "PCR primer pair associated with an amplicon/experiment.",
            "additionalProperties": false,
            "required": [
                "forward",
                "reverse"
            ],
            "properties": {
                "forward": {
                    "$ref": "#/$defs/decoratedOligo",
                    "description": "Forward primer as decorated oligo."
                },
                "reverse": {
                    "$ref": "#/$defs/decoratedOligo",
                    "description": "Reverse primer as decorated oligo."
                }
            }
        },
        "probe": {
            "type": "object",
            "description": "A hybridization probe with name, optional amplicon ID, and decorated oligo details.",
            "additionalProperties": false,
            "required": [
                "name",
                "oligo",
                "amplicon_id",
                "fluorophore",
                "quencher",
                "sense_antisense",
                "notes"
            ],
            "properties": {
                "name": {
                    "type": "string",
                    "minLength": 2,
                    "maxLength": 60,
                    "description": "Probe name exactly as used (e.g., 'N3-FAM(27)s')."
                },
                "amplicon_id": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Amplicon tag associated with the probe (e.g., 'K2', 'K3', 'N2', 'N3', 'B15')."
                },
                "oligo": {
                    "$ref": "#/$defs/decoratedOligo",
                    "description": "The probe's decorated oligo (sequence, labels, direction)."
                },
                "fluorophore": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Fluorophore name if identifiable; otherwise null."
                },
                "quencher": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Quencher name if identifiable; otherwise null."
                },
                "sense_antisense": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "enum": [
                        "sense",
                        "antisense",
                        null
                    ],
                    "description": "Sense/antisense designation inferred from probe name suffix (e.g., 's' or 'as')."
                },
                "notes": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "description": "Free-text notes about the probe (ambiguities, special chemistry)."
                }
            }
        }
    },
    "properties": {
        "experiment": {
            "description": "Full description of a single hybridization experiment instance related to this sequence",
            "type": "object",
            "additionalProperties": false,
            "required": [
                "experiment_raw_description",
                "sequences",
                "experiment_type",                
                "outcome",
                "experiment_properties"
            ],
            "properties": {
                "experiment_raw_description": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "minLength": 1,
                    "maxLength": 1000,
                    "description": "Verbatim or lightly tidied description of the experiment from the article."
                },
                "sequences": {
                    "type": "object",
                    "additionalProperties": false,
                    "description": "All sequences relevant to this target-probe experiment.",
                    "required": [
                        "target_sequence",
                        "probe",
                        "primer_sequences",
                        "related_sequences"
                    ],
                    "properties": {
                        "target_sequence": {
                            "oneOf": [
                                {
                                    "$ref": "#/$defs/decoratedOligo"
                                },
                                {
                                    "type": "string",
                                    "pattern": "^(Exact target sequence is unknown, here is its description: .*)$",
                                    "minLength": 70,
                                    "maxLength": 200
                                }
                            ],
                            "description": "Target genomic sequence if explicitly given; store as decorated oligo only if labels are present; otherwise just sequence and length."
                        },
                        "probe": {
                            "$ref": "#/$defs/probe",
                            "description": "The hybridization probe for this experiment."
                        },
                        "primer_sequences": {
                            "oneOf": [
                                {
                                    "$ref": "#/$defs/primerPair"
                                },
                                {
                                    "type": "null"
                                }
                            ],
                            "description": "Primers associated with this experiment/amplicon if provided."
                        },
                        "related_sequences": {
                            "type": "array",
                            "description": "Additional related sequences (controls, references), if any.",
                            "minItems": 0,
                            "maxItems": 50,
                            "items": {
                                "type": "object",
                                "additionalProperties": false,
                                "required": [
                                    "related_sequence",
                                    "description"
                                ],
                                "properties": {
                                    "related_sequence": {
                                        "$ref": "#/$defs/decoratedOligo",
                                        "description": "A related sequence (plain or decorated)."
                                    },
                                    "description": {
                                        "type": [
                                            "string",
                                            "null"
                                        ],
                                        "minLength": 1,
                                        "maxLength": 200,
                                        "description": "Short explanation of the related sequence's role."
                                    }
                                }
                            }
                        }
                    }
                },
                "experiment_type": {
                    "type": "object",
                    "description": "Description of this single hybridization experiment design.",
                    "additionalProperties": false,
                    "required": [
                        "probe_type",
                        "chemistry"
                    ],
                    "properties": {
                        "probe_type": {
                            "title": "Probe Type",
                            "description": "Functional design/mechanism class of the probe. Use when the probe's reporting/capture behavior is known.",
                            "oneOf": [
                                {
                                    "const": "linear",
                                    "title": "Linear",
                                    "description": "Simple oligo that hybridizes without structural activation; often end-labeled."
                                },
                                {
                                    "const": "molecular_beacon",
                                    "title": "Molecular beacon",
                                    "description": "Stem-loop with fluor/quencher; fluorescence turns on when the stem opens on target."
                                },
                                {
                                    "const": "hydrolysis_taqman",
                                    "title": "Hydrolysis (TaqMan)",
                                    "description": "Dual-labeled probe cleaved by 5'->3' exonuclease during PCR; signal increases on cleavage."
                                },
                                {
                                    "const": "fret_dual_hybridization",
                                    "title": "FRET dual-hybridization",
                                    "description": "Two adjacent probes with donor/acceptor dyes; FRET only when both bind nearby."
                                },
                                {
                                    "const": "scorpion",
                                    "title": "Scorpion",
                                    "description": "Primer-linked hairpin probe enabling fast intra-molecular reporting in qPCR."
                                },
                                {
                                    "const": "hcr",
                                    "title": "Hybridization Chain Reaction (HCR)",
                                    "description": "Initiator + hairpins polymerize upon target binding; enzyme-free signal amplification."
                                },
                                {
                                    "const": "branched_dna",
                                    "title": "Branched DNA (bDNA)",
                                    "description": "Signal amplification via multibranch DNA scaffolds without target amplification."
                                },
                                {
                                    "const": "padlock",
                                    "title": "Padlock",
                                    "description": "Linear probe circularizes on perfect match; detected via rolling-circle amplification."
                                },
                                {
                                    "const": "capture",
                                    "title": "Capture",
                                    "description": "Affinity-tagged probe used to enrich/pull down targets (e.g., biotinylated capture baits)."
                                },
                                {
                                    "const": "tiling_set",
                                    "title": "Tiling set",
                                    "description": "Multiple overlapping probes across a region/gene for robust detection."
                                },
                                {
                                    "const": "antisense",
                                    "title": "Antisense",
                                    "description": "Probe designed to bind and block or track transcripts (e.g., ISH tracking)."
                                }
                            ]
                        },
                        "chemistry": {
                            "title": "Chemistry Backbone",
                            "description": "Backbone and chemical modifications (sequence-level chemistry rather than labels/reporters). Primary nucleic-acid scaffold used by the probe.",
                            "oneOf": [
                                {
                                    "const": "dna",
                                    "title": "DNA",
                                    "description": "Unmodified DNA backbone."
                                },
                                {
                                    "const": "rna",
                                    "title": "RNA",
                                    "description": "Unmodified RNA backbone."
                                },
                                {
                                    "const": "cdna",
                                    "title": "cDNA",
                                    "description": "Complementary DNA derived from RNA."
                                },
                                {
                                    "const": "pna",
                                    "title": "PNA",
                                    "description": "Peptide nucleic acid backbone."
                                },
                                {
                                    "const": "morpholino",
                                    "title": "Morpholino",
                                    "description": "Morpholine-ring phosphorodiamidate backbone."
                                },
                                {
                                    "const": "lna_modified",
                                    "title": "LNA-modified",
                                    "description": "DNA/RNA with Locked Nucleic Acid residues incorporated."
                                },
                                {
                                    "const": "two_ome_rna",
                                    "title": "2'-O-Me RNA",
                                    "description": "2'-O-methyl RNA backbone."
                                }
                            ]
                        }
                    }
                },
                
                
                "experiment_properties": {
                    "type": "object",
                    "additionalProperties": false,
                    "description": "Quantitative and buffer parameters for this experiment.",
                    "required": [
                        "concentrations",
                        "parameters_SI"
                    ],
                    "properties": {
                        "concentrations": {
                            "type": "object",
                            "additionalProperties": false,
                            "description": "Concentration-related values.",
                            "required": [
                                "dna_rna_concentration",
                                "concentration_SI"
                            ],
                            "properties": {
                                "dna_rna_concentration": {
                                    "$ref": "#/$defs/measurement",
                                    "description": "Analyte concentration as reported (raw) plus normalized SI (mol/m^3)."
                                },
                                "concentration_SI": {
                                    "$ref": "#/$defs/measurement",
                                    "description": "Optional redundant SI-only concentration if the article already used SI; keep raw text synchronized."
                                }
                            }
                        },
                        "parameters_SI": {
                            "type": "object",
                            "additionalProperties": false,
                            "description": "Assay buffer/condition parameters, represented as raw + SI. If any value is not present, fill-in measurements fields as null.",
                            "required": [
                                "temperature",
                                "Tris",
                                "Na",
                                "K",
                                "Mg",
                                "DMSO"
                            ],
                            "properties": {
                                "temperature": {
                                    "$ref": "#/$defs/measurement",
                                    "description": "Temperature (e.g., '58 °C'), with SI in Kelvin."
                                },
                                "Tris": {
                                    "$ref": "#/$defs/measurement",
                                    "description": "Tris buffer concentration; SI in mol/m^3 (1 mM = 1 mol/m^3)."
                                },
                                "Na": {
                                    "$ref": "#/$defs/measurement",
                                    "description": "Sodium ion concentration; SI in mol/m^3."
                                },
                                "K": {
                                    "$ref": "#/$defs/measurement",
                                    "description": "Potassium ion concentration; SI in mol/m^3."
                                },
                                "Mg": {
                                    "$ref": "#/$defs/measurement",
                                    "description": "Magnesium ion concentration; SI in mol/m^3."
                                },
                                "DMSO": {
                                    "$ref": "#/$defs/measurement",
                                    "description": "DMSO amount (often % v/v); SI as dimensionless fraction (percent/100)."
                                }
                            }
                        }
                    }
                },
                "outcome": {
                    "type": "object",
                    "additionalProperties": false,
                    "description": "Results for this target-probe pairing.",
                    "required": [
                        "outcome",
                        "hybridization_probability",
                        "specificity",
                        "fluorescence",
                        "comparative_notes"
                    ],
                    "properties": {
                        "outcome": {
                            "type": [
                                "boolean",
                                "null"
                            ],
                            "description": "Boolean result if explicitly stated (e.g., success=true/failure=false). If not explicit, leave null."
                        },
                        "hybridization_probability":{
                            "type": "object",
                            "additionalProperties": false,
                            "required": ["numeric", "textual"],
                            "properties":{
                                "numeric": { "type": ["number", "null"], "description": "Probability of the probe to hybridize to the target in this hybridization experiment, if stated in the article text."},
                                "textual": { "type": ["string", "null"], "maxLength": 200, "description": "Explain the notes from the article regarding the probability of the probe to hybridize to the target in this hybridization experiment, even if the numeric value is not present."}
                            }
                        },
                        "specificity":{
                            "type": "object",
                            "additionalProperties": false,
                            "required": ["numeric", "textual"],
                            "properties":{
                                "numeric": { "type": ["number", "null"], "description": "Target specificity of the probe in this hybridization experiment, if stated in the article text."},
                                "textual": { "type": ["string", "null"], "maxLength": 200, "description": "Explain the notes from the article regarding the target specificity of the probe in this hybridization experiment, even if the numeric value is not present."}
                            }
                        },
                        "fluorescence": {
                            "$ref": "#/$defs/measurement",
                            "description": "Fluorescence or signal measurement (raw text + normalized form if numeric). If comparative only, keep statement in 'raw' and numeric fields null."
                        },
                        "comparative_notes": {
                            "type": [
                                "string",
                                "null"
                            ],
                            "minLength": 0,
                            "maxLength": 500,
                            "description": "Comparative statements (e.g., 'N3-FAM stronger in real-time PCR; N3-Cy5 stronger in DMA')."
                        }
                    }
                }
            }
        },
        "extraction_report": {
            "$ref": "#/$defs/extractionReport"
        }
    }
}